<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>shell basic | snippet</title>

  
  <meta name="author" content="grebeci">
  

  
  <meta name="description" content="Bash Scripting BasicsAssignment and Substitution12a=123b=$a

Variables
Butil-in Variables 
 $HOME $PWD $PATH for more info, see environ(7)

Positional">
  

  
  
  <meta name="keywords" content="SHELL">
  

  <meta id="viewport" name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">

  <meta property="og:title" content="shell basic"/>

  <meta property="og:site_name" content="snippet"/>

  
  <meta property="og:image" content="/favicon.ico"/>
  

  <link href="/favicon.ico" rel="icon">
  <link rel="alternate" href="/atom.xml" title="snippet" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
<meta name="generator" content="Hexo 6.3.0"></head>


<body>
<div class="blog">
  <div class="content">

    <header>
  <div class="site-branding">
    <h1 class="site-title">
      <a href="/">snippet</a>
    </h1>
    <p class="site-description"></p>
  </div>
  <nav class="site-navigation">
    <ul>
      
        <li><a href="/">Home</a></li>
      
        <li><a href="/archives">Archives</a></li>
      
        <li><a href="/categories">Categories</a></li>
      
        <li><a href="/tags">Tags</a></li>
      
    </ul>
  </nav>
</header>

    <main class="site-main posts-loop">
    <article>

  
    
    <h3 class="article-title"><span>shell basic</span></h3>
    
  

  <div class="article-top-meta">
    <span class="posted-on">
      <a href="/2022/10/15/shell/basic/" rel="bookmark">
        <time class="entry-date published" datetime="2022-10-15T14:55:06.000Z">
          2022-10-15
        </time>
      </a>
    </span>
  </div>


  

  <div class="article-content">
    <div class="entry">
      
        <h1 id="Bash-Scripting-Basics"><a href="#Bash-Scripting-Basics" class="headerlink" title="Bash Scripting Basics"></a>Bash Scripting Basics</h1><h3 id="Assignment-and-Substitution"><a href="#Assignment-and-Substitution" class="headerlink" title="Assignment and Substitution"></a>Assignment and Substitution</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">a=123</span><br><span class="line">b=<span class="variable">$a</span></span><br></pre></td></tr></table></figure>

<h3 id="Variables"><a href="#Variables" class="headerlink" title="Variables"></a>Variables</h3><ol>
<li><p>Butil-in Variables </p>
<p> <code>$HOME $PWD $PATH</code> for more info, see <a href="https://link.zhihu.com/?target=https://man7.org/linux/man-pages/man7/environ.7.html">environ(7)</a></p>
</li>
<li><p>Positional Parameters</p>
<p> <code>$0 $1 $2 $3 $4 $@ $* $#</code></p>
</li>
<li><p>Special Parameters<br> $? # exit status of a command, function, or the script itself</p>
<p> $$ # 当前进程的pid</p>
<p> $! # 后台运行的最后一个进程pid</p>
</li>
</ol>
<p>4.env</p>
<p>​	defined :<code>export var=&#39;123&#39;</code></p>
<p>​    print:  env | grep ‘HOME’</p>
<h3 id="array"><a href="#array" class="headerlink" title="array"></a>array</h3><h5 id="1-indexed-array"><a href="#1-indexed-array" class="headerlink" title="1. indexed array"></a>1. indexed array</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">myArray=(item1 item2 item3) <span class="comment"># create </span></span><br><span class="line"></span><br><span class="line"><span class="variable">$&#123;myArray[0]&#125;</span>  <span class="comment"># array in index</span></span><br><span class="line"><span class="variable">$&#123;myArray[@]&#125;</span>  <span class="comment"># arrray all</span></span><br><span class="line"><span class="variable">$&#123;myArray[*]&#125;</span>  <span class="comment"># arrray all &quot;$&#123;myArray[*]&#125;&quot; 加双引号看成整体</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">myArray[0]=value <span class="comment"># array set element</span></span><br><span class="line"></span><br><span class="line">length=<span class="variable">$&#123;#myArray[@]&#125;</span> <span class="comment"># array length</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$&#123;!array[@]&#125;</span>  or <span class="variable">$&#123;!array[*]&#125;</span> <span class="comment"># 输出有值的index</span></span><br><span class="line"><span class="variable">$&#123;array[@]:position:length&#125;</span>  <span class="comment"># slice</span></span><br><span class="line"> arr=(a b);arr+=(c d) <span class="comment"># add  (a b c d) </span></span><br><span class="line"> </span><br><span class="line"><span class="comment"># array iteration</span></span><br><span class="line"><span class="keyword">for</span> item <span class="keyword">in</span> <span class="variable">$&#123;myArray[@]&#125;</span>; <span class="keyword">do</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$item</span>&quot;</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h5 id="2-Associative-arrays"><a href="#2-Associative-arrays" class="headerlink" title="2. Associative arrays"></a>2. Associative arrays</h5><p>Bash 的新版本支持关联数组。关联数组使用字符串而不是整数作为数组索引。</p>
<p><code>declare -A</code>可以声明关联数组。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">decalre -A wordcount</span><br><span class="line"><span class="comment"># Assignment  </span></span><br><span class="line">wordcount[<span class="string">&#x27;aaa&#x27;</span>]=1</span><br><span class="line">wordcount[<span class="string">&#x27;bbb&#x27;</span>]=2</span><br><span class="line"> <span class="comment"># or</span></span><br><span class="line">wordcount=([<span class="string">&#x27;aaa&#x27;</span>]=1 [<span class="string">&#x27;bbb&#x27;</span>]=2)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#reference</span></span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$&#123;wordcount[&#x27;name&#x27;]&#125;</span></span><br></pre></td></tr></table></figure>



<h3 id="String"><a href="#String" class="headerlink" title="String"></a>String</h3><h5 id="1-substr"><a href="#1-substr" class="headerlink" title="1. substr"></a>1. substr</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$&#123;varname:offset:length&#125;</span> </span><br><span class="line"><span class="comment"># 返回变量$varname的子字符串，从位置offset开始（从0开始计算），长度为length.</span></span><br><span class="line"><span class="comment"># 注 ： offset为负值，表示从字符串的末尾开始算起。注意，负数前面必须有一个空格</span></span><br><span class="line"><span class="variable">$str</span>: -5：2&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h5 id="2-remove-substr"><a href="#2-remove-substr" class="headerlink" title="2. remove substr"></a>2. remove substr</h5><p>删除匹配的部分，返回剩下的部分</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#head pattern</span></span><br><span class="line"><span class="variable">$&#123;variable#pattern&#125;</span> <span class="comment"># 非贪婪</span></span><br><span class="line"><span class="variable">$&#123;variable##pattern&#125;</span> <span class="comment"># 贪婪</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#tail pattern </span></span><br><span class="line"><span class="variable">$&#123;variable%pattern&#125;</span></span><br><span class="line"><span class="variable">$&#123;variable%pattern&#125;</span></span><br></pre></td></tr></table></figure>

<h5 id="3-replace"><a href="#3-replace" class="headerlink" title="3.replace"></a>3.replace</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$&#123;variable/pattern/string&#125; # 贪婪匹配，只替换第一个</span><br><span class="line">$&#123;variable//pattern/string&#125;# 贪婪匹配，替换所有</span><br></pre></td></tr></table></figure>

<h5 id="4-lenth"><a href="#4-lenth" class="headerlink" title="4. lenth"></a>4. lenth</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 这些操作返回结果，不会改变字符串</span></span><br><span class="line"><span class="variable">$&#123;#varname&#125;</span> <span class="comment"># string length</span></span><br></pre></td></tr></table></figure>

<h5 id="5-upper-amp-lower"><a href="#5-upper-amp-lower" class="headerlink" title="5. upper &amp; lower"></a>5. upper &amp; lower</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># 转为大写</span><br><span class="line">$&#123;varname^^&#125;</span><br><span class="line"># 转为小写</span><br><span class="line">$&#123;varname,,&#125;</span><br></pre></td></tr></table></figure>



<h3 id="IO"><a href="#IO" class="headerlink" title="IO"></a>IO</h3><p>STDIN : 标准输入  0  &#x2F;dev&#x2F;stdin</p>
<p>STDOUT: 标准输出  1  &#x2F;dev&#x2F;stdout</p>
<p>STDERR: 标准错误  2  &#x2F;dev&#x2F;stderr</p>
<p>黑洞：  &#x2F;dev&#x2F;null</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">command &lt; input-file &gt; output-file # rewrite  </span><br><span class="line"></span><br><span class="line">command  &gt; output-file  2&gt;&amp;1  &lt;=&gt;  command &amp;&gt; output-file  # 合并标准输入和</span><br><span class="line">command &gt;output-file 2&gt; err-output-file </span><br><span class="line"></span><br><span class="line">command &gt;&gt; output-file 			# appending</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h5 id="heredoc"><a href="#heredoc" class="headerlink" title="heredoc"></a>heredoc</h5><p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/93993398">Heredoc 入门 - 知乎 (zhihu.com)</a></p>
<h3 id="Branches"><a href="#Branches" class="headerlink" title="Branches"></a>Branches</h3><h5 id="if"><a href="#if" class="headerlink" title="if"></a>if</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> [ condition1 ];<span class="keyword">then</span></span><br><span class="line">    command_series1</span><br><span class="line"><span class="keyword">elif</span> [ condition2 ];<span class="keyword">then</span></span><br><span class="line">    command_series2</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    default_command_series3</span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> [ condition1 ];<span class="keyword">then</span> command_series1 ; <span class="keyword">fi</span></span><br></pre></td></tr></table></figure>



<h5 id="case-command"><a href="#case-command" class="headerlink" title="case  command"></a>case  command</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">case</span> <span class="variable">$x</span> <span class="keyword">in</span></span><br><span class="line">	pattern1)</span><br><span class="line">  		;;</span><br><span class="line">  	pattern2)</span><br><span class="line">  		;;</span><br><span class="line">	*)</span><br><span class="line">     statementn</span><br><span class="line"><span class="keyword">esac</span></span><br></pre></td></tr></table></figure>

<h5 id="短路"><a href="#短路" class="headerlink" title="短路"></a>短路</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[[  ]] &amp;&amp; <span class="built_in">command</span>  <span class="comment"># if true then</span></span><br><span class="line">[[  ]] || <span class="built_in">command</span>  <span class="comment"># if false then</span></span><br></pre></td></tr></table></figure>



<h3 id="Conditional-Expressions"><a href="#Conditional-Expressions" class="headerlink" title="Conditional Expressions"></a>Conditional Expressions</h3><p>详见 <a target="_blank" rel="noopener" href="https://www.gnu.org/software/bash/manual/html_node/Bash-Conditional-Expressions.html#Bash-Conditional-Expressions">Bash Conditional Expressions (Bash Reference Manual) ~ Bash条件表达式(Bash参考手册) (gnu.org)</a></p>
<h6 id="运算符"><a href="#运算符" class="headerlink" title="运算符"></a>运算符</h6><p><code>[ ]</code> <code>[[  ]]</code> <code>test</code></p>
<blockquote>
<p>[ … ] : shell的命令，和<code>test</code>等价 </p>
<p>[[ …  ]] : shell 的关键字，支持字符串比较（包括正则</p>
<ol>
<li>[] : shell 命令，其中的表达式是他的命令行参数，所以 <code>&lt; &gt; &amp;&amp;</code> 必须转移</li>
</ol>
<p>[[]] : 关键字，不进行命令行扩展，（在[[和]]之间的所有的字符都不会被文件扩展或是标记分割，但是会有参数引用和命令替换</p>
</blockquote>
<h5 id="1-file"><a href="#1-file" class="headerlink" title="1. file"></a>1. file</h5><p>file exsit</p>
<pre><code>[ -d /bin]  # dir exist
[ -e filename ] # file exist
[ -f filename ]  #是否存在，且为普通文件
[ -s filename ]  #file 非空未真
</code></pre>
<p>file privilege</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[ -r filename ] <span class="comment"># read</span></span><br><span class="line">[ -w filename ] <span class="comment"># write</span></span><br><span class="line">[ -x filename ] <span class="comment"># run</span></span><br></pre></td></tr></table></figure>

<p>file modified time</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[ file1 -nt file2 ] <span class="comment"># file1 new time</span></span><br><span class="line">[ file1 -ot file2 ] <span class="comment"># file1 old time</span></span><br><span class="line">[ file1 -ef file2 ] <span class="comment"># inode equal =&gt; softlink -&gt; file</span></span><br></pre></td></tr></table></figure>

<h5 id="2-number-amp-string"><a href="#2-number-amp-string" class="headerlink" title="2. number &amp; string"></a>2. number &amp; string</h5><p>整数比较</p>
<p>-eq  -ne -gt -lt -ge -le </p>
<p>字符串</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-z -n == != &gt; &lt;</span><br></pre></td></tr></table></figure>

<p> 注： <code>&lt;</code> <code>&gt;</code> 只用于字符串字典序比较，且在 <code>[[  ]]</code> 无需转义 ， 在 <code>[ ]</code> 需要转义</p>
<p><code>==</code>,<code>!=</code> : 只能用于字符串</p>
<h5 id="3-正则"><a href="#3-正则" class="headerlink" title="3.正则"></a>3.正则</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[[ string =~ regex ]]</span><br></pre></td></tr></table></figure>

<h5 id="4-and-or"><a href="#4-and-or" class="headerlink" title="4.and or"></a>4.and or</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[ condition1 -a condition2 ]</span><br><span class="line">[ condition1 -o condition2 ]</span><br><span class="line"></span><br><span class="line">[[ condition1 &amp;&amp; condition2 ]]</span><br><span class="line">[[ condition1 || condition2 ]]</span><br></pre></td></tr></table></figure>



<h3 id="Loops"><a href="#Loops" class="headerlink" title="Loops"></a>Loops</h3><h4 id="vars-like-for"><a href="#vars-like-for" class="headerlink" title="vars-like for"></a>vars-like for</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> arg <span class="keyword">in</span> arg1 arg2 arg3 ; <span class="keyword">do</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="variable">$arg</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> arg <span class="keyword">in</span> arg1 arg2 arg3; <span class="keyword">do</span> <span class="built_in">echo</span> <span class="variable">$arg</span>; <span class="keyword">done</span></span><br></pre></td></tr></table></figure>

<h4 id="range-for"><a href="#range-for" class="headerlink" title="range for"></a>range for</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> arg <span class="keyword">in</span> `<span class="built_in">seq</span> 10`; <span class="keyword">do</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="variable">$arg</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">seq</span> 1 3 10   <span class="comment">#generate sequence  ， 使用空格分开的序列字符串</span></span><br><span class="line"><span class="built_in">echo</span> &#123;1..10..1&#125; <span class="comment">#  generate sequence  </span></span><br><span class="line">array=($(<span class="built_in">seq</span> 10)) <span class="comment"># 转成 array</span></span><br></pre></td></tr></table></figure>



<h4 id="for-in-C-like-syntax"><a href="#for-in-C-like-syntax" class="headerlink" title="for in C-like syntax"></a>for in C-like syntax</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">LIMIT=10</span><br><span class="line"><span class="keyword">for</span> ((a=1; a&lt;=LIMIT; a++)); <span class="keyword">do</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$a</span> &quot;</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>



<h4 id="while"><a href="#while" class="headerlink" title="while"></a><strong>while</strong></h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">LIMIT=10</span><br><span class="line">a=1</span><br><span class="line"><span class="keyword">while</span> ((a&lt;=LIMIT)); <span class="keyword">do</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$a</span> &quot;</span></span><br><span class="line">    ((a += 1))</span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>



<h4 id="until"><a href="#until" class="headerlink" title="until"></a><strong>until</strong></h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">LIMIT=10</span><br><span class="line">a=1</span><br><span class="line">util ((a &gt; LIMIT)); <span class="keyword">do</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$a</span> &quot;</span></span><br><span class="line">    ((a += 1))</span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>



<h3 id="Function"><a href="#Function" class="headerlink" title="Function"></a>Function</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># define a function</span></span><br><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">fun_name</span></span>()&#123;</span><br><span class="line">    <span class="built_in">command</span>...</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">## or</span></span><br><span class="line"><span class="function"><span class="title">fun_name</span></span>()&#123; <span class="comment"># arg1 arg2 arg3</span></span><br><span class="line">    <span class="built_in">command</span>...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># apply a function</span></span><br><span class="line">fun_name <span class="variable">$arg1</span> <span class="variable">$arg2</span> <span class="variable">$arg3</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># dereference</span></span><br><span class="line"><span class="function"><span class="title">fun_name</span></span>()&#123; <span class="comment"># arg1</span></span><br><span class="line">    <span class="built_in">eval</span> <span class="string">&quot;<span class="variable">$1</span>=hello&quot;</span></span><br><span class="line">&#125;</span><br><span class="line">fun_name arg1</span><br><span class="line"><span class="comment">## the above code block is equivalent to </span></span><br><span class="line">arg1=hello</span><br></pre></td></tr></table></figure>



<h3 id="Fork"><a href="#Fork" class="headerlink" title="Fork"></a>Fork</h3><p>子进程 <code>command</code> (command)</p>
<p>注：子shell exit失效，管道也会开启子shell</p>
<h3 id="etc"><a href="#etc" class="headerlink" title="etc"></a>etc</h3><h5 id="1-连续执行n条命令"><a href="#1-连续执行n条命令" class="headerlink" title="1. 连续执行n条命令  {} ()"></a>1. 连续执行n条命令  {} ()</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">（command1;command2) <span class="comment"># 开启子shell 执行</span></span><br><span class="line"></span><br><span class="line">&#123; command1;command2;&#125; <span class="comment"># 在当前shell 执行，开始空格，结尾分号</span></span><br></pre></td></tr></table></figure>

<h5 id="2-后台执行"><a href="#2-后台执行" class="headerlink" title="2. 后台执行"></a>2. 后台执行</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">nohup</span> <span class="built_in">command</span> &gt; <span class="built_in">log</span> 2&gt;&amp;1 </span><br></pre></td></tr></table></figure>



<h3 id="Debugging"><a href="#Debugging" class="headerlink" title="Debugging"></a>Debugging</h3><ol>
<li>take good use of sh(1)<br> for example:<br> sh -n script: checks for syntax<br> sh -v script: echo each command before executing it<br> sh -x script: echo the result of each command in an abbreviated manner</li>
<li>use echo</li>
<li>use trap</li>
</ol>
<h3 id="Parallel"><a href="#Parallel" class="headerlink" title="Parallel"></a>Parallel</h3><p>use GNU parallel</p>
<p>管道会开启子shell</p>
<h3 id="Script-with-Style"><a href="#Script-with-Style" class="headerlink" title="Script with Style"></a>Script with Style</h3><ol>
<li>Comment your code</li>
<li>Avoid using magic number</li>
<li>Use exit codes in a systematic and meaningful way</li>
<li>Use standardized parameter flags for script invocation</li>
</ol>
<h4 id="数值运算"><a href="#数值运算" class="headerlink" title="数值运算"></a>数值运算</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">var=$(expr 1 + 2) # 加号必须有空格</span><br><span class="line">let var=1+2 # 加号不能有空格</span><br><span class="line">ff=$(( 1+2 )) # 双括号必须有空格</span><br><span class="line">ff=$[ 1+2 ]</span><br></pre></td></tr></table></figure>

<h4 id="Bash-常用的快捷键"><a href="#Bash-常用的快捷键" class="headerlink" title="Bash 常用的快捷键"></a>Bash 常用的快捷键</h4>
      
    </div>

  </div>

  <div class="article-footer">
    <div class="article-meta pull-left">

    

    
    

    <span class="post-tags">
      <i class="icon-tags"></i>
        <a href="/tags/SHELL/">SHELL</a>
    </span>
    

    </div>

    
  </div>
</article>

  









    </main>

    <footer class="site-footer">
  <p class="site-info">
    Proudly powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and
    Theme by <a href="https://github.com/CodeDaraW/Hacker" target="_blank">Hacker</a>
    </br>
    
    &copy; 2022 grebeci
    
  </p>
</footer>
    
    
  </div>
</div>
</body>
</html>